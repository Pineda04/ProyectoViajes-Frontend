import { Link } from "react-router-dom";
import { MdCardTravel } from "react-icons/md";
import { BsHousesFill } from "react-icons/bs";
import { useState } from "react";
import { formatDate } from "../../../shared/utils/formatDate";

export function FluentMdl2AccountActivity(props) {
	return (<svg xmlns="http://www.w3.org/2000/svg" width={8} height={8} viewBox="0 0 2048 2048" {...props}><path fill="currentColor" d="M1792 256v1792H256V256h512q0-53 20-99t55-82t81-55t100-20q53 0 99 20t82 55t55 81t20 100zM640 384v128h768V384h-256V256q0-27-10-50t-27-40t-41-28t-50-10q-27 0-50 10t-40 27t-28 41t-10 50v128zm1024 0h-128v256H512V384H384v1536h1280zm-405 335q42 0 78 15t64 42t42 63t16 78q0 39-15 76t-43 65l-526 531l-358 68l75-351l526-530q28-28 65-42t76-15m51 249q21-23 21-51q0-31-20-50t-52-20q-14 0-27 4t-23 15l-499 503l-27 126l129-25z"></path></svg>);
}

export function StreamlineTravelMapTriangleFlagNavigationMapMapsFlagGpsLocationDestinationGoal(props) {
	return (<svg xmlns="http://www.w3.org/2000/svg" width={8} height={8} viewBox="0 0 14 14" {...props}><path fill="none" stroke="currentColor" strokeLinecap="round" strokeLinejoin="round" d="M2.5.5v13m0-13l9 4.5l-9 4.5"></path></svg>);
}

export function MaterialSymbolsTravelExplore(props) {
	return (<svg xmlns="http://www.w3.org/2000/svg" width={8} height={8} viewBox="0 0 24 24" {...props}><path fill="currentColor" d="M12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2q3.65 0 6.388 2.288t3.412 5.737h-2.05q-.475-1.825-1.713-3.262T15 4.6V5q0 .825-.587 1.413T13 7h-2v2q0 .425-.288.713T10 10H8v2h2v3H9l-4.8-4.8q-.075.45-.137.9T4 12q0 3.275 2.3 5.625T12 20zm9.1-.5l-3.2-3.2q-.525.3-1.125.5T15.5 19q-1.875 0-3.187-1.312T11 14.5t1.313-3.187T15.5 10t3.188 1.313T20 14.5q0 .675-.2 1.275t-.5 1.125l3.2 3.2zM15.5 17q1.05 0 1.775-.725T18 14.5t-.725-1.775T15.5 12t-1.775.725T13 14.5t.725 1.775T15.5 17"></path></svg>);
}

export function MaterialSymbolsFlightsmode(props) {
	return (<svg xmlns="http://www.w3.org/2000/svg" width={8} height={8} viewBox="0 0 24 24" {...props}><path fill="currentColor" d="m9.925 21.125l-2.475-4.6l-4.6-2.475l1.775-1.75l3.625.625l2.55-2.55L2.875 7l2.1-2.15l9.625 1.7l3.1-3.1q.575-.575 1.425-.575t1.425.575t.575 1.412t-.575 1.413L17.425 9.4l1.7 9.6L17 21.125L13.6 13.2l-2.55 2.55l.65 3.6z"></path></svg>);
}

export function UilUser(props) {
	return (<svg xmlns="http://www.w3.org/2000/svg" width={8} height={8} viewBox="0 0 24 24" {...props}><path fill="currentColor" d="M15.71 12.71a6 6 0 1 0-7.42 0a10 10 0 0 0-6.22 8.18a1 1 0 0 0 2 .22a8 8 0 0 1 15.9 0a1 1 0 0 0 1 .89h.11a1 1 0 0 0 .88-1.1a10 10 0 0 0-6.25-8.19M12 12a4 4 0 1 1 4-4a4 4 0 0 1-4 4"></path></svg>);
}

export function OuiCalendar(props) {
	return (<svg xmlns="http://www.w3.org/2000/svg" width={8} height={8} viewBox="0 0 16 16" {...props}><path fill="currentColor" fillRule="evenodd" d="M14 4v-.994C14 2.45 13.55 2 12.994 2H11v1h-1V2H6v1H5V2H3.006C2.45 2 2 2.45 2 3.006v9.988C2 13.55 2.45 14 3.006 14h9.988C13.55 14 14 13.55 14 12.994V5H2V4zm-3-3h1.994C14.102 1 15 1.897 15 3.006v9.988A2.005 2.005 0 0 1 12.994 15H3.006A2.005 2.005 0 0 1 1 12.994V3.006C1 1.898 1.897 1 3.006 1H5V0h1v1h4V0h1zM4 7h2v1H4zm3 0h2v1H7zm3 0h2v1h-2zM4 9h2v1H4zm3 0h2v1H7zm3 0h2v1h-2zm-6 2h2v1H4zm3 0h2v1H7zm3 0h2v1h-2z"></path></svg>);
}

export function PajamasComments(props) {
	return (<svg xmlns="http://www.w3.org/2000/svg" width={8} height={8} viewBox="0 0 16 16" {...props}><path fill="currentColor" fillRule="evenodd" d="M2 0a2 2 0 0 0-2 2v10.06l1.28-1.28l1.53-1.53H4V11a2 2 0 0 0 2 2h7l1.5 1.5L16 16V6a2 2 0 0 0-2-2h-2V2a2 2 0 0 0-2-2zm8.5 4V2a.5.5 0 0 0-.5-.5H2a.5.5 0 0 0-.5.5v6.44l.47-.47l.22-.22H4V6a2 2 0 0 1 2-2zm3.56 7.94l.44.439V6a.5.5 0 0 0-.5-.5H6a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 .5.5h7.621z" clipRule="evenodd"></path></svg>);
}

export const LastActivity = ({
  users = [],
  activities = [],
  destinations = [],
  pointsInterest = [],
  travelPackages = [],
  flights = [],
  hostings = [],
  reservations = [],
  assessments = [],
}) => {
  const sections = [
    {
      icon: UilUser,
      title: "Usuarios",
      items: users,
      color: "blue",
      link: "/administration/users",
      getLabel: (item) => `${item.firstName} ${item.lastName}`
    },
    {
      icon: FluentMdl2AccountActivity,
      title: "Actividades",
      items: activities,
      color: "green",
      link: "/administration/activities",
      getLabel: (item) => item.name
    },
    {
      icon: StreamlineTravelMapTriangleFlagNavigationMapMapsFlagGpsLocationDestinationGoal,
      title: "Puntos de Interés",
      items: pointsInterest,
      color: "orange",
      link: "/administration/points-interest",
      getLabel: (item) => item.name
    },
    {
      icon: MaterialSymbolsTravelExplore,
      title: "Destinos",
      items: destinations,
      color: "purple",
      link: "/administration/destinations",
      getLabel: (item) => item.name
    },
    {
      icon: MdCardTravel,
      title: "Paquetes de Viaje",
      items: travelPackages,
      color: "pink",
      link: "/administration/travel-packages",
      getLabel: (item) => item.name
    },
    {
      icon: MaterialSymbolsFlightsmode,
      title: "Vuelos",
      items: flights,
      color: "indigo",
      link: "/administration/flights",
      getLabel: (item) => item.airline
    },
    {
      icon: BsHousesFill,
      title: "Hospedajes",
      items: hostings,
      color: "cyan",
      link: "/administration/hostings",
      getLabel: (item) => item.name
    },
    {
      icon: OuiCalendar,
      title: "Reservaciones",
      items: reservations,
      color: "lime",
      link: "/administration/reservations",
      getLabel: (item) => item.reservationDate
    },
    {
      icon: PajamasComments,
      title: "Reseñas",
      items: assessments,
      color: "amber",
      link: "/administration/assessments",
      getLabel: (item) => `Reseña de ${item.userId}`
    }
  ];

  const ActivitySection = ({ icon: Icon, title, items, color, link, getLabel }) => {
    const [activeItem, setActiveItem] = useState(null);

    return (
      <div className="relative group">
        <div className="absolute -inset-0.5 bg-gradient-to-r from-transparent via-gray-100 to-transparent opacity-30 rounded-xl blur-sm group-hover:opacity-50 transition duration-300"></div>
        <div className="relative bg-white border border-gray-100 rounded-xl overflow-hidden shadow-lg transform transition-all hover:shadow-xl">
          {/* Parte del encabezado */}
          <div 
            className={`
              flex items-center justify-between p-4 
              bg-gradient-to-r 
              from-${color}-50 
              to-${color}-100 
              border-b border-gray-100
            `}
          >
            <div className="flex items-center space-x-3">
              <div className={`
                p-2 rounded-full 
                bg-white 
                shadow-md
                ring-2 ring-${color}-100
              `}>
                <Icon className={`w-6 h-6 text-${color}-600`} />
              </div>
              <h3 className="text-sm font-bold text-gray-800">{title}</h3>
            </div>
            
            <Link 
              to={link} 
              className="
                text-gray-600 
                hover:text-gray-800 
                transition 
                flex items-center 
                space-x-1
                text-xs
                bg-white 
                px-2 
                py-1 
                rounded-full 
                shadow-sm
                hover:shadow-md
              "
            >
              <span>Ver más</span>
              <svg 
                xmlns="http://www.w3.org/2000/svg" 
                className="h-4 w-4" 
                fill="none" 
                viewBox="0 0 24 24" 
                stroke="currentColor"
              >
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 7l5 5m0 0l-5 5m5-5H6" />
              </svg>
            </Link>
          </div>

          {/* Contenido */}
          <div className="p-2">
            {items.slice(0, 4).map((item, index) => (
              <div 
                key={item.id}
                onMouseEnter={() => setActiveItem(index)}
                onMouseLeave={() => setActiveItem(null)}
                className={`
                  flex items-center 
                  space-x-3 
                  p-2 
                  rounded-lg 
                  cursor-pointer 
                  transition 
                  duration-300
                  ${activeItem === index 
                    ? `bg-${color}-50 shadow-sm` 
                    : 'hover:bg-gray-50'}
                `}
              >
                <div className={`
                  w-2 h-2 rounded-full 
                  ${activeItem === index 
                    ? `bg-${color}-500` 
                    : 'bg-gray-300'}
                `}></div>
                
                <div className="flex-grow">
                  <p className="text-xs font-medium text-gray-700 truncate">
                    {getLabel(item)}
                  </p>
                  <p className="text-[10px] text-gray-400">
                    Creado el {formatDate(item.createdDate)}
                  </p>
                </div>
                
                {activeItem === index && (
                  <div className="opacity-70 hover:opacity-100 transition">
                    <Link to={link}>
                      <svg 
                        xmlns="http://www.w3.org/2000/svg" 
                        className="h-4 w-4 text-gray-500" 
                        fill="none" 
                        viewBox="0 0 24 24" 
                        stroke="currentColor"
                      >
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                      </svg>
                    </Link>
                  </div>
                )}
              </div>
            ))}
          </div>
        </div>
      </div>
    );
  };

  return (
    <div className="grid md:grid-cols-4 sm:grid-cols-2 gap-6">
      {sections.map((section, index) => (
        <ActivitySection key={index} {...section} />
      ))}
    </div>
  );
};